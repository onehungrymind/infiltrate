<div class="completion-assessment">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <div>
        <h1>MVP Completion Assessment</h1>
        <p class="subtitle">Last Updated: {{ lastUpdated() }}</p>
      </div>
      <div class="overall-progress">
        <div class="progress-circle warning" [style.--progress]="overallCompletion()">
          <span class="progress-value">{{ overallCompletion() }}%</span>
        </div>
        <span class="progress-label">Overall Completion</span>
      </div>
    </div>
  </div>

  <!-- KPI Cards -->
  <div class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-icon kpi-icon-green">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <div class="kpi-content">
        <span class="kpi-value">{{ strongAreas() }}</span>
        <span class="kpi-label">Strong Areas</span>
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-icon kpi-icon-red">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
        </svg>
      </div>
      <div class="kpi-content">
        <span class="kpi-value">{{ criticalGapCount() }}</span>
        <span class="kpi-label">Critical Gaps</span>
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-icon kpi-icon-blue">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <div class="kpi-content">
        <span class="kpi-value">{{ functionalCount() }}</span>
        <span class="kpi-label">Functional Components</span>
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-icon kpi-icon-orange">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
        </svg>
      </div>
      <div class="kpi-content">
        <span class="kpi-value">{{ missingCount() }}</span>
        <span class="kpi-label">Missing Integration</span>
      </div>
    </div>
  </div>

  <!-- Executive Summary -->
  <div class="summary-row">
    <div class="summary-card summary-have">
      <h3>What We Have</h3>
      <ul>
        @for (item of whatWeHave(); track item) {
          <li>{{ item }}</li>
        }
      </ul>
    </div>
    <div class="summary-card summary-missing">
      <h3>What's Missing</h3>
      <ul>
        @for (item of whatsMissing(); track item) {
          <li>{{ item }}</li>
        }
      </ul>
    </div>
  </div>

  <!-- Area Status -->
  <div class="section">
    <div class="section-header">
      <h2>Area Status</h2>
      <p class="section-subtitle">Components vs Integration Layer</p>
    </div>

    <div class="area-list">
      @for (area of areaStatus(); track area.name) {
        <div class="area-item">
          <div class="area-header">
            <span class="area-name">{{ area.name }}</span>
            <span class="area-status" [ngClass]="getAreaStatusClass(area.status)">
              {{ getAreaStatusLabel(area.status) }}
            </span>
          </div>
          <div class="area-progress-row">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="area.progress" [style.backgroundColor]="area.color"></div>
            </div>
            <span class="progress-percent">{{ area.progress }}%</span>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- Two Column Layout: Critical Gaps + Priority Roadmap -->
  <div class="two-column-row">
    <!-- Critical Gaps -->
    <div class="section">
      <div class="section-header">
        <h2>Critical Gaps</h2>
        <p class="section-subtitle">What's blocking a functional learning experience</p>
      </div>

      <div class="gap-list">
        @for (gap of criticalGaps(); track gap.name) {
          <div class="gap-item">
            <div class="gap-header">
              <span class="gap-name">{{ gap.name }}</span>
              <span class="gap-progress">{{ gap.progress }}%</span>
            </div>
            <p class="gap-problem">{{ gap.problem }}</p>
            <div class="gap-details">
              <div class="gap-current">
                <strong>Have:</strong>
                @for (item of gap.currentState; track item) {
                  <span class="gap-tag have">{{ item }}</span>
                }
              </div>
              <div class="gap-missing">
                <strong>Need:</strong>
                @for (item of gap.missingItems; track item) {
                  <span class="gap-tag need">{{ item }}</span>
                }
              </div>
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Priority Roadmap -->
    <div class="section">
      <div class="section-header">
        <h2>Priority Roadmap</h2>
        <p class="section-subtitle">Recommended implementation order</p>
      </div>

      <div class="priority-section">
        <h4 class="priority-header p0">P0 - Foundation (Required for user testing)</h4>
        @for (item of p0Items(); track item.name) {
          <div class="priority-item" [class.completed]="item.status === 'complete'">
            <span class="status-icon" [ngClass]="getPriorityStatusClass(item.status)">{{ getPriorityStatusIcon(item.status) }}</span>
            <div class="priority-content">
              <span class="priority-name" [class.line-through]="item.status === 'complete'">{{ item.name }}</span>
              <span class="priority-desc">{{ item.description }}</span>
            </div>
          </div>
        }
      </div>

      <div class="priority-section">
        <h4 class="priority-header p1">P1 - Core Experience</h4>
        @for (item of p1Items(); track item.name) {
          <div class="priority-item" [class.completed]="item.status === 'complete'">
            <span class="status-icon" [ngClass]="getPriorityStatusClass(item.status)">{{ getPriorityStatusIcon(item.status) }}</span>
            <div class="priority-content">
              <span class="priority-name" [class.line-through]="item.status === 'complete'">{{ item.name }}</span>
              <span class="priority-desc">{{ item.description }}</span>
            </div>
          </div>
        }
      </div>

      <div class="priority-section">
        <h4 class="priority-header p2">P2 - Polish</h4>
        @for (item of p2Items(); track item.name) {
          <div class="priority-item" [class.completed]="item.status === 'complete'">
            <span class="status-icon" [ngClass]="getPriorityStatusClass(item.status)">{{ getPriorityStatusIcon(item.status) }}</span>
            <div class="priority-content">
              <span class="priority-name" [class.line-through]="item.status === 'complete'">{{ item.name }}</span>
              <span class="priority-desc">{{ item.description }}</span>
            </div>
          </div>
        }
      </div>
    </div>
  </div>

  <!-- Component Status Grid -->
  <div class="section">
    <div class="section-header">
      <h2>Component Status</h2>
      <p class="section-subtitle">Functional components vs missing integration layer</p>
    </div>

    <div class="component-grid two-col">
      <!-- Functional Components -->
      <div class="component-card">
        <div class="component-header">
          <div class="component-title">
            <span class="component-name">Functional Components</span>
            <span class="component-rate complete">{{ functionalCount() }} complete</span>
          </div>
        </div>
        <div class="component-list">
          @for (item of functionalComponents(); track item.name) {
            <div class="component-item">
              <span class="status-icon" [ngClass]="getStatusClass(item.status)">{{ getStatusIcon(item.status) }}</span>
              <span class="component-item-name">{{ item.name }}</span>
            </div>
          }
        </div>
      </div>

      <!-- Missing Integration -->
      <div class="component-card missing">
        <div class="component-header">
          <div class="component-title">
            <span class="component-name">Missing Integration Layer</span>
            <span class="component-rate missing">{{ missingCount() }} missing</span>
          </div>
        </div>
        <div class="component-list">
          @for (item of missingIntegration(); track item.name) {
            <div class="component-item">
              <span class="status-icon" [ngClass]="getStatusClass(item.status)">{{ getStatusIcon(item.status) }}</span>
              <span class="component-item-name">{{ item.name }}</span>
            </div>
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Honest Assessment -->
  <div class="honest-assessment">
    <h3>Honest Assessment</h3>
    <div class="assessment-content">
      <p><strong>What we built this session:</strong></p>
      <ul>
        <li>Complete BullMQ pipeline with three workers</li>
        <li>WebSocket gateway for real-time progress updates</li>
        <li>UI that updates dynamically as entities are created during build</li>
        <li>Reconnection support so page refresh doesn't break active builds</li>
      </ul>
      <p><strong>What we haven't built:</strong> A learning experience. A student cannot currently:</p>
      <ul>
        <li>See a structured curriculum</li>
        <li>Know what to learn next</li>
        <li>Track progress toward mastery</li>
        <li>Prove competency</li>
        <li>Follow a guided path</li>
      </ul>
      <p><strong>The gap:</strong> The authoring/admin side is now at ~90%. The learner experience is at 20%. Overall ~78% complete.</p>
      <p><strong>Path forward:</strong></p>
      <ol>
        <li><strong>Learner Dashboard</strong> - Show what's been built in a consumable way</li>
        <li><strong>Progress Rollup</strong> - Track mastery at concept level</li>
        <li><strong>Guided Learning</strong> - "What should I do next?"</li>
      </ol>
    </div>
  </div>

  <!-- Legend -->
  <div class="legend">
    <div class="legend-item">
      <span class="legend-icon bg-green-100 text-green-700">✓</span>
      <span>Complete</span>
    </div>
    <div class="legend-item">
      <span class="legend-icon bg-red-100 text-red-700">✗</span>
      <span>Missing</span>
    </div>
    <div class="legend-item">
      <span class="legend-icon bg-gray-100 text-gray-700">○</span>
      <span>Not Started</span>
    </div>
  </div>
</div>
