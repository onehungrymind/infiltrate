<div class="container">
  <div class="header">
    <h1>Schema Rankings with BFS</h1>
    <p class="subtitle">Algorithm Visualization</p>
  </div>

  <div class="info-row">
    <div class="info-box">
      <h3>
        <span class="icon">
          <svg viewBox="0 0 24 24">
            <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z" />
          </svg>
        </span>
        Queue
      </h3>
      <div class="queue-items">
        @if (queueDisplay().length === 0) {
          <span style="opacity: 0.5;">Empty</span>
        } @else {
          @for (item of queueDisplay(); track $index) {
            <div class="queue-item">{{ item[0] }}: {{ item[1] }}</div>
          }
        }
      </div>
    </div>

    <div class="info-box">
      <h3>
        <span class="icon">
          <svg viewBox="0 0 24 24">
            <path
              d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
            />
          </svg>
        </span>
        Ranks
      </h3>
      <div class="ranks-items">
        @if (!hasRanks()) {
          <span style="opacity: 0.5;">None yet</span>
        } @else {
          @for (item of ranksEntries(); track item[0]) {
            <div class="rank-item">{{ item[0] }}: {{ item[1] }}</div>
          }
        }
      </div>
    </div>

    <div class="info-box current-step">
      <div>{{ stepDescription() }}</div>
    </div>
  </div>

  <div class="main-content">
    <div class="graph-container">
      <svg #graphSvg id="graph"></svg>
    </div>

    <div class="code-panel">
      <div class="code-header">
        <span class="icon">
          <svg viewBox="0 0 24 24">
            <path
              d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"
            />
          </svg>
        </span>
        Code Execution
      </div>
      <div class="code-container" #codeDisplay>
        @for (line of codeLines; track line.num) {
          <div 
            class="code-line" 
            [class.highlight]="isLineHighlighted(line.num)"
            [attr.data-line]="line.num">
            <span class="line-number">{{ line.num }}</span>
            <span class="line-content" [innerHTML]="line.content"></span>
          </div>
        }
      </div>
    </div>
  </div>

  <div class="controls-wrapper">
    <div class="controls">
      <button (click)="start()" [disabled]="isPlaying() || !canGoNext()">START</button>
      <button (click)="pause()" [disabled]="!isPlaying()">PAUSE</button>
      <button (click)="reset()">RESET</button>
      <button (click)="prev()" [disabled]="!canGoPrev() || isPlaying()">PREV</button>
      <button (click)="next()" [disabled]="!canGoNext() || isPlaying()">NEXT</button>

      <div class="speed-control">
        <label>SPEED</label>
        <input
          type="range"
          [value]="speed()"
          (input)="onSpeedChange($event)"
          min="500"
          max="3000"
          step="100"
        />
        <span>{{ speedDisplay() }}</span>
      </div>
    </div>

    <div class="legend">
      <div class="legend-item">
        <div
          class="legend-circle"
          style="background: #1a1a1a; border-color: #444"
        ></div>
        <span>Unvisited</span>
      </div>
      <div class="legend-item">
        <div
          class="legend-circle"
          style="background: #00ff87; border-color: #00ff87"
        ></div>
        <span>Current</span>
      </div>
      <div class="legend-item">
        <div
          class="legend-circle"
          style="background: #1a3a2a; border-color: #00ff87"
        ></div>
        <span>Queued</span>
      </div>
      <div class="legend-item">
        <div
          class="legend-circle"
          style="background: #2a2a2a; border-color: #00ff87"
        ></div>
        <span>Visited</span>
      </div>
    </div>
  </div>
</div>