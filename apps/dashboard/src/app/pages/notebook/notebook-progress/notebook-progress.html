<div class="notebook-progress-container">
  <h1>Notebook Progress</h1>

  @if (loading()) {
    <div class="loading">
      <mat-spinner></mat-spinner>
      <p>Loading progress...</p>
    </div>
  }

  @if (error()) {
    <div class="error">
      <mat-card>
        <mat-card-content>
          <mat-icon>error</mat-icon>
          {{ error() }}
        </mat-card-content>
      </mat-card>
    </div>
  }

  @if (!loading() && !error() && progressList().length === 0) {
    <div class="empty-state">
      <mat-card>
        <mat-card-content>
          <p>No notebook progress found. Start working on a notebook to see your progress here!</p>
        </mat-card-content>
      </mat-card>
    </div>
  }

  @if (!loading() && progressList().length > 0) {
    <div class="progress-list">
      @for (progress of progressList(); track progress.notebookId) {
        <mat-card class="progress-card">
          <mat-card-header>
            <mat-card-title>{{ progress.notebookId }}</mat-card-title>
            <mat-card-subtitle>
              Completion: {{ (progress.completionRate * 100).toFixed(0) }}%
            </mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <div class="exercises">
              <h3>Exercise Status</h3>
              <div class="exercise-list">
                @for (exerciseNum of [1, 2, 3, 4, 5]; track exerciseNum) {
                  <div
                    class="exercise-item"
                    [class]="'exercise-' + getExerciseStatus(progress, exerciseNum)"
                  >
                    <mat-icon [color]="getStatusColor(getExerciseStatus(progress, exerciseNum))">
                      {{ getStatusIcon(getExerciseStatus(progress, exerciseNum)) }}
                    </mat-icon>
                    <span>Exercise {{ exerciseNum }}</span>
                  </div>
                }
              </div>
            </div>
            <div class="metadata">
              @if (progress.lastSubmittedAt) {
                <p>
                  <strong>Last Submitted:</strong> {{ progress.lastSubmittedAt | date:'short' }}
                </p>
              }
              <p>
                <strong>Updated:</strong> {{ progress.updatedAt | date:'short' }}
              </p>
            </div>
          </mat-card-content>
        </mat-card>
      }
    </div>
  }
</div>
