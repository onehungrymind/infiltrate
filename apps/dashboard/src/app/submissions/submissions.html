<div class="master-detail-layout">
  <div class="master-panel">
    @if (error()) {
      <div class="error-message">
        <svg class="error-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
        <span>{{ error() }}</span>
      </div>
    } @else if (!loaded()) {
      <div class="loading-message">
        <mat-spinner diameter="40"></mat-spinner>
        <span>Loading submissions...</span>
      </div>
    } @else {
      <app-search-filter-bar
        placeholder="Search by title or content..."
        [filterConfigs]="filterConfigs()"
        (searchChange)="onSearchFilterChange($event)"
      ></app-search-filter-bar>
      <app-submissions-list
        [submissions]="submissions()"
        [selectedSubmission]="selectedSubmission()"
        (selected)="selectSubmission($event)"
        (deleted)="deleteSubmission($event)"
      ></app-submissions-list>
    }
  </div>
  <div class="detail-panel">
    <app-submission-detail
      [submission]="selectedSubmission()"
      [availableChallenges]="challenges()"
      [availableProjects]="projects()"
      (saved)="saveSubmission($event)"
      (cancelled)="cancel()"
      (submitForReview)="submitForReview($event)"
      (requestFeedback)="requestAiFeedback($event)"
      (fileUploaded)="handleFileUpload($event)"
    ></app-submission-detail>
    @if (selectedSubmission()?.id) {
      <app-submission-feedback
        [submissionId]="selectedSubmission()?.id || ''"
        [loading]="feedbackLoading()"
      ></app-submission-feedback>
    }
  </div>
</div>
